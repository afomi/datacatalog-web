<% content_for :title do %>
    Browse
<% end %>

<% content_for :body_class do %>browse<% end %>

<div id="column_fullWidth">
  <div id="filterData">
    <ul>
      <li>
        <label for="organization_list">Organization</label>
        <%= select_tag 'organization_list', options_for_select(@organizations) %>
      </li>
      <li>
        <label for="format_list">Format</label>
        <select id="format_list">
          <option value="all">All</option>
          <option value="1">XML</option>
          <option value="2">CSV</option>
          <option value="3">JSON</option>
        </select>
      </li>
      <li>
        <label for="source_type_list">Source Type</label>
        <select id="source_type_list">
          <option value="all">All</option>
          <option value="dataset">Dataset</option>
          <option value="api">API</option>
        </select>
      </li>
      <li>
        <label for="release_year_list">Release Year</label>
        <select id="release_year_list">
          <option value="all">All</option>
          <option value="2000">2000</option>
          <option value="2001">2001</option>
          <option value="2002">2002</option>
          <option value="2003">2003</option>
          <option value="2004">2004</option>
          <option value="2005">2005</option>
          <option value="2006">2006</option>
          <option value="2007">2007</option>
          <option value="2008">2008</option>
          <option value="2009">2009</option>
        </select>
      </li>
      <li id="submit">
        <button class="filterBtn" type="submit">
          <span>Filter Data</span>
        </button>
      </li>
    </ul>  
    <div class="clear"></div>  
  </div>
  <div class="tableNav">
    <%= render 'shared/pagination' %>
  </div>
  <table id="browseTable">
    <thead>
      <tr id="titles">
        <th class="left">Data Set</th>
        <th class="center">Rating</th>
        <th class="center">Organization</th>
        <th class="right">Formats</th>
      </tr>
    </thead>
    <tbody>
      <% @sources.page(@page).each do |source| -%>
      
      <tr class="<%= cycle 'even','odd' %>">
        <td class="dataContent left">
          <%= link_to source.title, source_path(source.slug), :class => "dataName" %>
          <!--<button title="Favorite this data" class="iconFavorite" type="submit">
            <span>Favorite this data</span>
          </button>-->
          <p class="clear"><%= truncate(source.description, :length => 350) %></p>
        </td>
        <td class="center">
          <%= render 'shared/star_rating', :rating => (source.rating_stats.average ? source.rating_stats.average.round : nil) %>
        </td>
        <td class="center"><%= DataCatalog::Organization.get(source.organization_id).name %></td>
        <td class="right">
          <% unless source.downloads.empty? -%>
          <ul class="downloadFormats">
            <% source.downloads.each do |download| %>
            <li>
              <a href="#"><%= download.format.upcase %></a>
              <% unless download['size'].blank? %>
                <span>(<%= download['size'] %>)</span>
              <% end %>
            </li>
            <% end %>
          </ul>
          <% end %>
        </td>
      </tr>
      <% end # @sources.each -%>
    </tbody>
  </table>    
  <div class="tableNav">
    <%= render 'shared/pagination' %>
    <!--><div class="perPage">
      <dl>
        <dt>Results Per Page:</dt>
        <dd class="first">20</dd>
        <dd><a href="#">100</a></dd>
      </dl>
    </div>-->
  </div>
</div>
  